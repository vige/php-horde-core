From ecea6ea740419e19122a50579ba2903c1cb71d7a Mon Sep 17 00:00:00 2001
From: Michael J Rubinsky <mrubinsk@horde.org>
Date: Tue, 25 Sep 2018 12:10:39 -0400
Subject: [PATCH] Bug: 14857

Escape user supplied $color value and prevent XSS vuln.
---
 lib/Horde/Core/Ui/VarRenderer/Html.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/Horde_Core-2.27.6/lib/Horde/Core/Ui/VarRenderer/Html.php
+++ b/Horde_Core-2.27.6/lib/Horde/Core/Ui/VarRenderer/Html.php
@@ -580,7 +580,7 @@
         $varname = $this->_genID($var->getVarName(), false);
         $color = $var->getValue($vars);
         if ($color) {
-            $style = ' style="background-color:' . $color . ';color:'
+            $style = ' style="background-color:' . htmlspecialchars($color) . ';color:'
                 . (Horde_Image::brightness($color) < 128 ? '#fff' : '#000') . '"';
         } else {
             $style = '';
@@ -1423,7 +1423,7 @@
     protected function _renderVarDisplay_colorpicker($form, &$var, &$vars)
     {
         $color = $var->getValue($vars);
-        return '<span style="background-color:' . $color . ';color:'
+        return '<span style="background-color:' . htmlspecialchars($color) . ';color:'
             . (Horde_Image::brightness($color) < 128 ? '#fff' : '#000')
             . '">' . $color . '</span>';
     }
